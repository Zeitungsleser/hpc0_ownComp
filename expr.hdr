@ "ustr.hdr"
@ "gen.hdr"

enum ExprKind
{
    EXPR_BINARY,
    EXPR_ADD,
    EXPR_DIV,
    EXPR_MUL,
    EXPR_SUB,
    EXPR_ASSIGN,
    EXPR_BINARY_END,
    
    EXPR_UNARY,
    EXPR_ADDR,
    EXPR_DEREF,
    EXPR_UNARY_END,

    EXPR_PRIMARY,
    EXPR_INTEGER,
    EXPR_IDENTIFIER,
    EXPR_PRIMARY_END,
};

struct Expr
{
    kind:           ExprKind;
    left, right:    -> Expr;
    decimal:        -> UStr;
    identifier:     -> UStr;
    child:          -> Expr;
};

//constructors
extern fn createBinaryExpr(kind: ExprKind, left: ->Expr, right: ->Expr): ->Expr;
extern fn createIntegerExpr(val: -> UStr): ->Expr;
extern fn createIdentifierExpr(name: -> UStr): -> Expr;
extern fn createUnaryExpr(kind: ExprKind, child: -> Expr): -> Expr;

//destructor
extern fn releaseExpr(expr: ->Expr);

//methods
extern fn printExprTree(expr: ->Expr);
extern fn printExprLatexTree(expr: -> Expr);
extern fn loadExpr(expr: ->Expr): GenReg;
extern fn addressableExpr(expr: -> Expr): bool;
